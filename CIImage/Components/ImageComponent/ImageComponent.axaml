<ci:ComponentBase
    x:Class="CIImage.Components.ImageComponent"
    x:TypeArguments="components:ImageComponentConfig"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:ci="http://classisland.tech/schemas/xaml/core"
    xmlns:components="clr-namespace:CIImage.Components"
    xmlns:converters="clr-namespace:CIImage.Converters"
    xmlns:asyncImageLoader="clr-namespace:AsyncImageLoader;assembly=AsyncImageLoader.Avalonia"
    Loaded="Component_Loaded"
    Unloaded="Component_Unloaded">

    <ci:ComponentBase.Resources>
        <converters:CornerRadiusConverter x:Key="CornerRadiusConverter" />
    </ci:ComponentBase.Resources>

    <Grid VerticalAlignment="Center"
          DataContext="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=components:ImageComponent}}">
        <StackPanel Orientation="Horizontal">
            <Border
                CornerRadius="{Binding Settings.CornerRadius, Converter={StaticResource CornerRadiusConverter}, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"
                ClipToBounds="True">
                <asyncImageLoader:AdvancedImage x:Name="ImageViewer" Height="36" />
            </Border>
        </StackPanel>
    </Grid>
</ci:ComponentBase>